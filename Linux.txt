Linux и все, все, все

Linux - ядро, модули, системные утилиты и утилиты
Дистрибутив Linux - системные службы, графические оболочки и всевозможное программное обеспечение вместе с Linux-уровнями составляют

Ядро представляет собой один файл с названием vmlinuz-хххххххххх (где хххххххххх - это версия ядра), расположенный в каталоге /boot.
Модули расположены в каталоге /lib/modules.

Загрузка Linux
Программа проводит начальную настройку (инициализацию) устройств компьютера (материнская плата, процессор, память, жесткий диск, видео-подсистема и т.д.) и выясняет с какого устройства будет продолжена загрузка. Как правило таким устройством является жесткий диск (”винчестер”) на котором записана загрузочная запись - MBR (Master Boot Record). Эта запись расположена на самом первом секторе жесткого диска и занимает размер всего 512 байт. В эти 512 байт входит начальный загрузчик (446 байт), таблица разделов диска (64 байта) и так называемый специальный код в 511-м и 512-м байтах, который указывает на, то, что диск является загрузочным (содержит MBR). Как раз с помощью проверки этих двух последних байт БИОС и определяет является ли диск загрузочным или нет.

Задача начального загрузчика определить активный раздел диска и загрузить в память загрузчик ядра операционной системы
GRUB. Основное преимущество GRUB в том, что он умеет обращаться к файловой системе Linux.
Задача загрузчика загрузить в память ядро операционной системы и передать ему управление.

Ядро на диске находится в сжатом виде, поэтому происходит еще такая процедура как распаковка ядра и уже потом оно записывается в область оперативной памяти, которая недоступна пользовательским процессам.

Загрузчик может передавать ядру некоторые параметры, которые влияют на загрузку системы. Например, если передать ядру параметр single, то Linux загрузится в однопользовательском режиме. Параметры передаваемые ядру прописаны в конфигурационном файле. Для GRUB это файл /boot/grub/menu.lst. Как работать с GRUB пока останавливаться не будем, вернемся к этому вопросу в дальнейшем если будет время.

Дальше ядро загружает несколько системных процессов: менеджер памяти и менеджер процессов. И только потом загружается первый пользовательский процесс - init. Процесс init является основным (родительским) процессом с идентификатором 1. Это первый процесс к которому имеет доступ системный администратор. Система Linux работает до тех пор пока “жив” процесс init . Получив управление, init выполняет алгоритм описанный в конфигурационном файле /etc/inittab . В результате работы init запускаются скрипты собранные в директории /etc/init.d/ .

Справка man
С ее помощью можно получить информацию о командах
Открывается она в редакторе less.
Популярные примеры использования:
	man passwd - покажет всю справку о команде passwd
	man -k network - ключ -k позволяет показать все команды связанные с network
	man -k  network | grep manager - отобразим результаты, где есть слово manager
	man -f pwd - так мы посмотрим что выполняет определенная команда

Команда whereis. Эта команда позволяет показать где расположен исполняемый файл той или иной команды
	whereis pwd
	
	
Обзор основных директрорий 

/bin - в этом каталоге размещаются утилиты (исполняемые файлы) для работы на уровне системы. Из примеров можно привести ls, date, cp, pwd и т.д.
/sbin - в этом каталоге размещены системные утилиты и программы, которые предназначены для управления самой системой. Пример: shutdown, init, ifconfig.
/boot - в этом каталоге размещены файлы запуска системы: ядро, файлы GRUB, initrd, а также файл конфигурации ядра. initrd - это образ RAM-диска который используется для того, чтобы смонтировать временную файловую систему на время загрузки ядра. По сути initrd содержит необходимые модули которые позволят смонтировать реальную файловую систему и продолжить инициализацию и загрузку системы.
/etc - в этом каталоге находится большинство конфигурационных файлов системы. Содержим много подкаталогов каждый их которых отвечает за определенную область.
/home - в этом каталоге размещаются домашние каталоги пользователей зарегистрированных в системе.
/root - каталог пользователя root.
/lib - в этом каталоге хранятся библиотеки операционной системы и приложений.
	/lib/modules/ - каталог содержащий модули ядра. В этом каталоге расположены подкаталоги, которые совпадают с версиями ядра, которые были установлены в системе. То есть для каждой версии ядра есть свой набор модулей.
/mnt - каталог предназначен для монтирования в нем блочных устройств, которые не являются частью системыLinux
/media - предназначен для монтирования блочных устройств которые подключаются физически к системе в процессе ее работы.
/usr - в этом каталоге сохраняются все приложения (не путать с утилитами). Файлы Linux-приложений в отличии от Windows-приложений хранятся в соответствующих папках в зависимости от типа. Поэтому в каталоге /usr есть такие подкаталоги как /etc - для файлов конфигураций, /bin - для исполняемых файлов, /lib - библиотеки приложений и другие.
/tmp - Каталог для хранения временных файлов, которые необходимы во время работы программ.
/var - в этом каталоге хранятся различные системные файлы такие как, например, журналы различных подсистем или буферные каталоги принтеров, электронной почты и т.д
	/var/log/ - здесь как раз и содержатся файлы-журналы
	/var/lock/ - здесь храняться файлы котороые сигнализируют о блокировке того или иного ресурса системы.
	/var/run/ - в этом каталоге запущенные службы создают подкаталоги в которых содержится файл и идентификатором процесса службы.
/dev - в данном каталоге находятся особые типы файлов - файлы-устройства. Можно сказать, что эти файлы - это точки доступа к “железу” компьютера. Пока же нужно понять, что каждый файл в каталоге /dev представляет собой реальное физическое или логическое устройство.
/proc - здесь находится виртуальная файловая система Linux, в которой отображаются файлы-процессы. Другими словами через файлы содержащиеся в каталоге /proc мы получаем доступ к различным статистическим (и не только) данным ядра.
/sys - sys имеет свою файловую систему sysfs. В чем-то содержимое каталога (по назначению) /sys схоже с каталогом /proc . Основное отличие в том, что файлы в /sys описывают реальную конфигурацию компьютера на текущий момент.

Пользователи и группы.

/etc/passwd - здесь перечислены все пользователи локальной системы
/etc/shadow -  	файл в котором хранятся пароли пользователей, а точнее их хеш. Если в этом файле перед хешем поставить !, то пользователь будет считаться заблокированным.
/etc/group - в файле хранится информация о группах 

Создание нового пользователя:
	adduser test

Удаление пользователя
	deluser test - просто удаляем из системы, без удаления личного католога и информации
	deluser test -remove-home - удаляем вместе с каталогами /home/user/ и /var/mail/
	deluser test –remove-all-files - удаляем абсолютно все файлы
	
Изменение пароля
	passwd test
	
Создание группы и добавление/нее в нее пользователя
	addgroup group1 - создание group1
	addgroup test group1 - добавления пользователя test в группу
	delgroup group1 - удаление группы
	delgroup test group1 - удаление пользователя из группы
		

Процессы Linux. nice-фактор. Команда ps.

PID - Идентификатор процесса
PPID - идентификатора родительского процесса
UID - указывает владельца процесса (идентификатор пользователя)
GID -  указывает идентификатор группы процессов

Для того чтобы породить новый процесс, родительский вызывает функцию ядра fork(), в результате которой происходит клонирование родительского процесса и получается абсолютно одинаковый процесс на начальном этапе. Единственное отличие: у дочернего процесса увеличивается PID.

В определенный момент времени работать может только один процесс. Но так как переключение между процессами происходит очень быстро (тысячи переключений в секунду), то создается впечатление, что все они работают одновременно. Сколько процессорного времени и других ресурсов выделить каждому процессу решает менеджер процессов. В принятии этого решения играет роль такой параметр процесса как nice (или nice-фактор). nice-фактор - это числовое значение. Чем оно больше тем меньше ресурсов (процессорного времени и т.д.) будет выделятся процессу во время его работы.

тобы увидеть информацию о nice-факторе необходимо выполнить команду ps lax.

Процессы могут находиться в 4 состояниях:1. Выполнение - менеджер процессов выделил все необходимые ресурсы и процесс просто ждет своей очереди на получение следующей порции процессорного времени.
	1.(R) Выполнение - менеджер процессов выделил все необходимые ресурсы и процесс просто ждет своей очереди на получение следующей порции процессорного времени.
	2.(S) Ожидание - процесс получил все ресурсы, но для продолжения работы он ждет какую-то информацию, например, от другого процесса. 
	3.(T) Остановленный - процесс ничего не делает, процессорное время не получает. Процесс был переведен в это состояние с помощью специальных сигналов и выйти из этого состояния может также только с помощью соответствующего сигнала.
	4.(Z) “Зомби” - это процесс который должен был завершиться с освобождением всех ресурсов, но по какой-то причине завершение не произошло корректно. С процессами “Зомби” нужно быть осторожными. Если таких процессов много значит в системе что-то не так.



	




























